## 批量梯度下降

### R代码实现
```r
# input为预测变量；output为响应变量；learningRate为学习速率；iter为迭代次数；minLoss为可接受的误差阈值，即一旦误差小于该值，则代码停止执行
BatchGradientDecent <-
  function(input,output,learningRate,iter,minLoss) {
    w <- runif(n = 2,min = 0.1,max = 1)
    if (ncol(input) != length(w) || nrow(input) != length(output) || iter < 1) {
      stop()
    }
    loss <- runif(n = 1,min = 0.1,max = 1)
    vw <- list()
    for (i in 1:iter) {
      if (loss > minLoss) {
        errorSum <- output - rowSums(t(t(input) * w))
        w[1] <- w[1] + w[1] * learningRate * sum(errorSum * input[,1])
        w[2] <- w[2] + w[2] * learningRate * sum(errorSum * input[,2])
        loss <-
          0.5 * sum((output - rowSums(t(t(
            input
          ) * w))) ^ 2)
        vw[[i]] <- c(w[1],w[2],loss)
      }
    }
    return(vw)
  }
```

### 测试
+ 模拟测试数据
```r
input <- matrix(data = c(1,4,2,5,5,1,4,2),nrow = 4,byrow = TRUE)
output <- c(19,26,19,20)
```
+ 测试代码
```r
vwChange <- BatchGradientDecent(input = input,output = output,learningRate = 0.001,iter = 200,minLoss = 0.0001)
data <- t(sapply(vwChange,FUN = '['))
```



## 随机梯度下降

### R语言实现
```r
# input为预测变量；output为响应变量；learningRate为学习速率；iter为迭代次数；minLoss为可接受的误差阈值，即一旦误差小于该值，则代码停止执行
StochasticGradientDescent <-
  function(input,output,learningRate,iter,minLoss) {
    w <- runif(n = 2,min = 0.1,max = 1)
    n <- ncol(input)
    m <- nrow(input)
    if (n != length(w) || m != length(output) || iter < 1) {
      stop()
    }
    loss <- runif(n = 1,min = 0.1,max = 1)
    vw <- list()
    for (i in 1:iter) {
      for (j in 1:nrow(input)) {
        if (loss > minLoss) {
          errorSum <- output[j] - rowSums(t(input[j,]) * w)
          w[1] <- w[1] + w[1] * learningRate * sum(errorSum * input[j,1])
          w[2] <- w[2] + w[2] * learningRate * sum(errorSum * input[j,2])
          loss <-
            0.5 * sum((output - rowSums(t(t(
              input
            ) * w))) ^ 2)
          vw[[4*(i-1)+j]] <- c(w[1],w[2],loss)
        }
      }
    }
    return(vw)
  }
```

### 测试
+ 模拟测试数据
```r
input <- matrix(data = c(1,4,2,5,5,1,4,2),nrow = 4,byrow = TRUE)
output <- c(19,26,19,20)
```
+ 测试代码
```r
vwChange2 <- StochasticGradientDescent(input = input,output = output,learningRate = 0.001,iter = 200,minLoss = 0.0001)
data2 <- t(sapply(vwChange2,FUN = '['))
```
